<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ampsci: Basic Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ampsci
   </div>
   <div id="projectbrief">c++ program for high-precision atomic structure calculations of single-valence systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Basic Tutorial</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md8"></a> brief Basic tutorial for using ampsci, including examples.</p>
<p>This assumes you already have ampsci compiled.</p>
<ul>
<li>See <a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2compilation.html">doc/compilation.md</a> for compilation instructions</li>
<li>See <a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2tutorial__advanced.html">doc/tutorial_advanced.md</a> for a more advanced tutorial, including correlation corrections</li>
<li>and <a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2tutorial__CI.html">doc/tutorial_CI.md</a> for tutorial on Configuration Interaction (+MBPT) calculations for two-valence systems</li>
<li>There are several examples in <a href="doc/examples/">doc/examples/</a> - also try running those, and comparing the output to the expected output</li>
</ul>
<h1>Contents</h1>
<ul>
<li><a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2tutorial.html#start">Getting started</a></li>
<li><a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2tutorial__CI.html#basic">Running basic calculations</a></li>
<li><a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2tutorial.html#input">Setting up the input file</a><ul>
<li><a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2tutorial.html#example">Example: running calculation using input file</a></li>
</ul>
</li>
<li><a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2tutorial.html#output">Output format</a></li>
<li><a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2tutorial.html#modules">Modules: using the wavefunctions</a></li>
</ul>
<h1>Getting started <a class="anchor" id="start"></a></h1>
<p>Open up a terminal and navigate to the directory where ampsci was compiled.</p>
<ul>
<li>If you are unsure using the terminal, see <a href="https://ubuntu.com/tutorials/command-line-for-beginners">this tutorial (ubuntu)</a> (It's specifically for ubuntu (linux), but is mostly the same on mac)</li>
</ul>
<p>First, just run the executable:</p>
<div class="fragment"><div class="line">./ampsci</div>
</div><!-- fragment --><p>No calculation was performed, however, some instructions should be printed to the screen. These should serve as a reminder if you forget any of the commands we will look at below. You can also run:</p>
<div class="fragment"><div class="line">./ampsci -h</div>
</div><!-- fragment --><p>which will print the same.</p>
<p>Now, try the following, which should print the current <em>version</em> info (including the git commit hash, if you're using git). You can use this to check which exact version of the code you are running. This is also automatically printed when you run any calculation.</p>
<div class="fragment"><div class="line">./ampsci -v</div>
</div><!-- fragment --><h1>Running basic calculations <a class="anchor" id="basic"></a></h1>
<p>To actually perform an atomic calculation, we need to tell ampsci what we want to calculate.</p>
<p>Typically, this is done using an input file where we specify all the options. For very simple calculations, however, we can do this directly from the command line using the form:</p>
<div class="fragment"><div class="line">./ampsci &lt;Atom&gt; &lt;Core&gt; &lt;Valence&gt;</div>
</div><!-- fragment --><p>(where <code>&lt;Core&gt;</code> and <code>&lt;Valence&gt;</code> are both optional). For example, the following should all produce the same result. They will calculate Hartree-Fock for Cs, including all the electrons in the "core" (so-called \(V^N\) approximation).</p>
<div class="fragment"><div class="line">./ampsci Cs</div>
<div class="line">./ampsci Cs [Cs]</div>
<div class="line">./ampsci Cs [Xe],6s1</div>
</div><!-- fragment --><ul>
<li>The format for the "core" configuration copies that used by NIST in their periodic table. A nice copy can be downloaded from <a href="https://www.nist.gov/image/periodic-table">here</a>.</li>
<li>Usually the term in the brackets <code>[]</code> is a noble gas, but in ampsci you can put any atom (the core configuration for non-noble-gas atoms is guessed based on simple filling rules, and is sometimes not correct, so always check the output!).</li>
</ul>
<p>The next few cases will calculate Hartree-Fock for Cs, using the \(V^{N-1}\) approximation, including valence states up to \(n=7\) for \(s\) and \(p\) states, and \(n=5\) for \(d\) states:</p>
<div class="fragment"><div class="line">./ampsci Cs [Xe] 7sp5d</div>
</div><!-- fragment --><h1>Setting up the input file <a class="anchor" id="input"></a></h1>
<p>For anything more complicated, we must use an input file.</p>
<p>Input is a plain text file that consists of sets of 'Blocks' and 'Options'.</p>
<ul>
<li>Blocks are followed by curly-braces: BlockName{}</li>
<li>Options are followed by a semi-colon: OptionName = option_value;</li>
<li>Generally, each Block will have a set of Options that may be set</li>
<li>Nearly all are optional - leave them blank and a default value will be used</li>
<li>Blocks may be nested inside other Blocks</li>
<li>White-space is ignored, as are ''' and '"' characters</li>
<li>You may use C++-style line '//' and block '/**/' comments</li>
</ul>
<p>Firstly, we can use the code to tell us which input options are available using the <code>-a</code> (or <code>--ampsci</code>) command-line option:</p>
<div class="fragment"><div class="line">./ampsci -a</div>
</div><!-- fragment --><p>This will print the list of available top-level "Input Blocks". The output will look something like this:</p>
<div class="fragment"><div class="line"><span class="comment">// Available ampsci options/blocks</span></div>
<div class="line">ampsci{</div>
<div class="line">  <span class="comment">// These are the top-level ampsci input blocks and options. Default values are</span></div>
<div class="line">  <span class="comment">// given in square brackets following the description: [default_value]. Blocks</span></div>
<div class="line">  <span class="comment">// end with &#39;{}&#39;, options end with &#39;;&#39;. run `ampsci -a BlockName` (for any of</span></div>
<div class="line">  <span class="comment">// the following blocks) to see all the options available for that block.</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Which atom to run for</span></div>
<div class="line">  Atom{}</div>
<div class="line">  <span class="comment">// Set nuclear parameters</span></div>
<div class="line">  Nucleus{}</div>
<div class="line">  <span class="comment">// Set radial grid/lattice parameters</span></div>
<div class="line">  <a class="code hl_class" href="classGrid.html">Grid</a>{}</div>
<div class="line">  <span class="comment">// Options for solving atomic system</span></div>
<div class="line">  HartreeFock{}</div>
<div class="line">  <span class="comment">// Inlcude QED radiative potential</span></div>
<div class="line">  RadPot{}</div>
<div class="line">  <span class="comment">// Include an extra effective potential. Rarely used.</span></div>
<div class="line">  ExtraPotential{}</div>
<div class="line">  <span class="comment">// Basis of HF eigenstates used for MBPT</span></div>
<div class="line">  Basis{}</div>
<div class="line">  <span class="comment">// Options for MBPT and correlation corrections</span></div>
<div class="line">  Correlations{}</div>
<div class="line">  <span class="comment">// Like basis, but includes correlations. Used for sum-over-states</span></div>
<div class="line">  Spectrum{}</div>
<div class="line">  <span class="comment">// Configuration Interaction</span></div>
<div class="line">  <a class="code hl_namespace" href="namespaceCI.html">CI</a>{}</div>
<div class="line">  <span class="comment">// Run any number of modules (* -&gt; module name). `ampsci -m` to see available</span></div>
<div class="line">  <span class="comment">// modules</span></div>
<div class="line">  <a class="code hl_namespace" href="namespaceModule.html">Module</a>::*{}</div>
<div class="line">}</div>
<div class="ttc" id="aclassGrid_html"><div class="ttname"><a href="classGrid.html">Grid</a></div><div class="ttdoc">Holds grid, including type + Jacobian (dr/du)</div><div class="ttdef"><b>Definition</b> Grid.hpp:31</div></div>
<div class="ttc" id="anamespaceCI_html"><div class="ttname"><a href="namespaceCI.html">CI</a></div><div class="ttdoc">Functions and classes for Configuration Interaction calculations.</div><div class="ttdef"><b>Definition</b> CI_Integrals.cpp:11</div></div>
<div class="ttc" id="anamespaceModule_html"><div class="ttname"><a href="namespaceModule.html">Module</a></div><div class="ttdoc">Modules are run using calculated atomic wavefunctions.</div><div class="ttdef"><b>Definition</b> Module_Kionisation.cpp:44</div></div>
</div><!-- fragment --><p>This will be in the correct format for the input file, so we can start making our input file by copy+pasting these. We don't need all the options, so let's start with just the basics: <code>Atom{}</code>, <code>Grid{}</code>, and <code>HartreeFock{}</code>. In each of these blocks, we can specify certain options; most have default values, and can be thus left blank. We can also ask the code to tell us which options are available for each block, for example:</p>
<div class="fragment"><div class="line">./ampsci -a Atom</div>
</div><!-- fragment --><p>The output will list all options for the <code>Atom{}</code> block:</p>
<div class="fragment"><div class="line"><span class="comment">// Available Atom options/blocks</span></div>
<div class="line">Atom{</div>
<div class="line">  <span class="comment">// Atomic number or symbol (e.g., 55 or Cs). [H]</span></div>
<div class="line">  Z;</div>
<div class="line">  <span class="comment">// Atomic mass number, for nuclear parameters including finite nuclear size.</span></div>
<div class="line">  <span class="comment">// Default based on Z.</span></div>
<div class="line">  A;</div>
<div class="line">  <span class="comment">// Fractional variation of the fine-structure constant, alpha^2: (a/a0)^2. Use</span></div>
<div class="line">  <span class="comment">// to enforce the non-relativistic limit (c-&gt;infinity =&gt; alpha-&gt;0), or</span></div>
<div class="line">  <span class="comment">// calculate sensitivity to variation of alpha. [1.0]</span></div>
<div class="line">  varAlpha2;</div>
<div class="line">  <span class="comment">// Optional label for output identity - for distinguishing outputs with</span></div>
<div class="line">  <span class="comment">// different parameters</span></div>
<div class="line">  run_label;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This is also in the correct format for the input file, so we can copy+paste into our input file.</p>
<ul>
<li>Anything after <code>//</code> is a comment and will be ignored by the program.</li>
<li>Don't forget to close the curly braces <code>}</code> at the end of each input block, and the semi-colon <code>;</code> after each option!</li>
</ul>
<p>We can list more than one block name for this. For example, try:</p>
<div class="fragment"><div class="line">./ampsci -a Grid HartreeFock</div>
</div><!-- fragment --><p>which will give something like:</p>
<div class="fragment"><div class="line"><span class="comment">// Available Grid options/blocks</span></div>
<div class="line"><a class="code hl_class" href="classGrid.html">Grid</a>{</div>
<div class="line">  <span class="comment">// Options for radial grid (lattice) used for integrations, solving equations</span></div>
<div class="line">  <span class="comment">// and storing oritals. All relevant quantities are in units of Bohr radius</span></div>
<div class="line">  <span class="comment">// (aB).</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initial grid point, in aB [1.0e-6]</span></div>
<div class="line">  r0;</div>
<div class="line">  <span class="comment">// Finial grid point [120.0]</span></div>
<div class="line">  rmax;</div>
<div class="line">  <span class="comment">// Number of grid points [2000]</span></div>
<div class="line">  num_points;</div>
<div class="line">  <span class="comment">// Type of grid: loglinear, logarithmic, linear [loglinear]</span></div>
<div class="line">  type;</div>
<div class="line">  <span class="comment">// Only used for loglinear: grid is ~ logarithmic for r&lt;b, linear for r&gt;b</span></div>
<div class="line">  <span class="comment">// [rmax/3]</span></div>
<div class="line">  b;</div>
<div class="line">  <span class="comment">// du is uniform grid step size; set this instead of num_points - will</span></div>
<div class="line">  <span class="comment">// override num_points [default set by num_points]. Rarely used.</span></div>
<div class="line">  du;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Available HartreeFock options/blocks</span></div>
<div class="line">HartreeFock{</div>
<div class="line">  <span class="comment">// Options for solving lowest-order atomic wavefunction</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Core configuration. Either list entire core, or use [At] short-hand. e.g.,</span></div>
<div class="line">  <span class="comment">// [He] equivilant to 1s2; [Xe],6s1 equivilant to [Cs] and to</span></div>
<div class="line">  <span class="comment">// 1s2,2s2,...,5p6,6s1. Instead of one of the commas, you may use a &#39;:&#39; -</span></div>
<div class="line">  <span class="comment">// states above this are included into the core, but not excluded from the</span></div>
<div class="line">  <span class="comment">// valence list. Use this method for KohnSham, for example. [blank by default]</span></div>
<div class="line">  core;</div>
<div class="line">  <span class="comment">// Valence configuration in `basis string&#39; format. e.g., 7sp5df will include</span></div>
<div class="line">  <span class="comment">// valence states up to  n=7 for s and p, and up to n=5 for d and f states.</span></div>
<div class="line">  <span class="comment">// Automatically excludes states in the core (except those above the optional</span></div>
<div class="line">  <span class="comment">// &#39;:&#39;). [blank by default]</span></div>
<div class="line">  valence;</div>
<div class="line">  <span class="comment">// HF convergance goal [1.0e-13]</span></div>
<div class="line">  eps;</div>
<div class="line">  <span class="comment">// Method for mean-field approximation: HartreeFock, Hartree, KohnSham, Local</span></div>
<div class="line">  <span class="comment">// [HartreeFock]</span></div>
<div class="line">  method;</div>
<div class="line">  <span class="comment">// Scale for factor for Breit Hamiltonian. Usially 0.0 (no Breit) or 1.0 (full</span></div>
<div class="line">  <span class="comment">// Breit), but can take any value. [0.0]</span></div>
<div class="line">  Breit;</div>
<div class="line">  <span class="comment">// Include QED? Three options: true, false, valence. If &#39;valencel, will</span></div>
<div class="line">  <span class="comment">// include QED only into valence states, but not the core. Detailed QED</span></div>
<div class="line">  <span class="comment">// options are set within the RadPot{} block - if that block is not set,</span></div>
<div class="line">  <span class="comment">// defaults will be used. By default, this option is false, unless the</span></div>
<div class="line">  <span class="comment">// RadPot{} block exists, in which case it is true</span></div>
<div class="line">  QED;</div>
<div class="line">}</div>
</div><!-- fragment --><h2>Example: running calculation using input file <a class="anchor" id="example"></a></h2>
<p>We will use the above to create our first simple We will call this text file <code>example.in</code>, but any filename is OK (the <code>.in</code> file extension is just by convention; you may use <code>.txt</code> or anything else). We may then set up the input file like:</p>
<div class="fragment"><div class="line"><span class="comment">// example.in</span></div>
<div class="line">Atom{</div>
<div class="line">  Z = Cs; <span class="comment">// Or Z = 55;</span></div>
<div class="line">  A = 133; <span class="comment">// may leave blank for default isotope</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_class" href="classGrid.html">Grid</a>{</div>
<div class="line">  r0 = 1.0e-6;</div>
<div class="line">  rmax = 150.0;</div>
<div class="line">  num_points = 3000;</div>
<div class="line">}</div>
<div class="line">HartreeFock{</div>
<div class="line">  core = [Xe];</div>
<div class="line">  valence = 7sp5d;</div>
<div class="line">}</div>
</div><!-- fragment --><p>From the <code>Atom{}</code> block, we have chosen to run calculations for Cs-133. Since we did not set any parameters in the <code>Nucleus{}</code> block, the code will run using the default nuclear parameters (which are looked up based on the isotope).</p>
<p>In the <code>Grid{}</code> block, we specify the discrete radial grid to have <code>3000</code> grid points dispersed between the range <code>[1.0e-6, 150.0]</code> atomic units (atomic unit of length is the Bohr radius: \(1\,{\rm au}=1\,a_0 = \tfrac{4\pi\epsilon_0\hbar^2}{m_e e^2}\approx 5.3\times10^{-11}\,{\rm m}\)). Since we did not specify a grid <code>type</code> the default (log-linear) will be used (see <a href="https://ampsci.dev/ampsci.pdf">ampsci.pdf</a>).</p>
<p>Finally, in the <code>HartreeFock{}</code> block, we specify that we wish to solve Hartree-Fock equations for Cs with a Xe-like core, and consider valence states up to \(n=5\) for \(s,p\)-states, and \(n=5\) for \(d\)-states. Since a Xenon-like core has 1 fewer electrons than neutral Cs, this is a \(V^{N-1}\) calculation. Note that the format for the core configuration copies that used by NIST in their periodic table. A nice copy can be downloaded from <a href="https://www.nist.gov/image/periodic-table">here</a>.</p>
<p>You may also use the built-in periodic table to see the possible ground-state electron configuration:</p>
<div class="fragment"><div class="line">./ampsci -p</div>
<div class="line">or</div>
<div class="line">./ampsci -p Cs</div>
</div><!-- fragment --><p>Caution: this "guesses" the configuration based on simple filling rules, so may not be the true ground-state configuration.</p>
<h1>Output format <a class="anchor" id="output"></a></h1>
<p>If we run the code with the above input file:</p>
<div class="fragment"><div class="line">./ampsci example.in</div>
</div><!-- fragment --><p>we will get something like the following output:</p>
<div class="fragment"><div class="line">********************************************************************************</div>
<div class="line">AMPSCI v: 0.0 [dev/16c2fe5e]*</div>
<div class="line"> *(Modified: M doc/modules.md M doc/tutorial.md)</div>
<div class="line">Parallel: Using OpenMP with 24 threads.</div>
<div class="line">Compiled: g++-13 [Ubuntu 13.1.0-8ubuntu1~22.04] 13.1.0 2024-07-12 15:40 AEST</div>
<div class="line">Run time: 2024-07-12 15:43:32</div>
<div class="line"> </div>
<div class="line">********************************************************************************</div>
<div class="line">Atom { </div>
<div class="line">  Z = Cs;</div>
<div class="line">  A = 133;</div>
<div class="line">}</div>
<div class="line">Grid { </div>
<div class="line">  r0 = 1.0e-6;</div>
<div class="line">  rmax = 150.0;</div>
<div class="line">  num_points = 3000;</div>
<div class="line">}</div>
<div class="line">HartreeFock { </div>
<div class="line">  core = [Xe];</div>
<div class="line">  valence = 7sp5d;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">Running for Cs, Z=55 A=133</div>
<div class="line">Fermi nucleus;  r_rms = 4.8041, c_hdr = 5.67073, t = 2.3</div>
<div class="line">Log-linear (b=5.0e+01) grid: 1.0e-06 -&gt; 1.5e+02, N=3000, du=3.6e-01</div>
<div class="line">========================================================</div>
<div class="line">Hartree-Fock</div>
<div class="line">Core   :  it: 28 eps=6.0e-14 for 4d-</div>
<div class="line">Val    :  it: 38 eps=0.0e+00 for 6s+ [ 38 eps=0e+00 for 6s+]</div>
<div class="line"> </div>
<div class="line">Cs-133</div>
<div class="line">Core: [Xe] V^N-1</div>
<div class="line">     state  k   Rinf its   eps         En (au)        En (/cm)</div>
<div class="line">0   1s_1/2 -1    0.6  2  3e-26 -1330.118948578  -291927365.908</div>
<div class="line">1   2s_1/2 -1    1.6  2  2e-23  -212.564531454   -46652522.182</div>
<div class="line">2   2p_1/2  1    1.7  2  9e-24  -199.429544822   -43769725.833</div>
<div class="line">3   2p_3/2 -2    1.7  2  1e-23  -186.436652689   -40918115.622</div>
<div class="line">4   3s_1/2 -1    3.5  2  1e-21   -45.969754347   -10089194.889</div>
<div class="line">5   3p_1/2  1    3.7  2  7e-22   -40.448315683    -8877379.174</div>
<div class="line">6   3p_3/2 -2    3.8  2  7e-22   -37.894321340    -8316842.207</div>
<div class="line">7   3d_3/2  2    4.4  2  4e-22   -28.309520221    -6213221.515</div>
<div class="line">8   3d_5/2 -3    4.5  2  5e-22   -27.775176726    -6095946.673</div>
<div class="line">9   4s_1/2 -1    7.7  2  1e-20    -9.512819127    -2087822.471</div>
<div class="line">10  4p_1/2  1    8.7  2  8e-21    -7.446283819    -1634270.396</div>
<div class="line">11  4p_3/2 -2    9.1  2  9e-21    -6.920999546    -1518983.824</div>
<div class="line">12  4d_3/2  2   12.8  2  6e-21    -3.485619407     -765005.034</div>
<div class="line">13  4d_5/2 -3   13.0  2  6e-21    -3.396901914     -745533.795</div>
<div class="line">14  5s_1/2 -1   19.8  2  7e-21    -1.489803443     -326974.062</div>
<div class="line">15  5p_1/2  1   25.7  2  3e-21    -0.907896945     -199260.347</div>
<div class="line">16  5p_3/2 -2   26.7  2  3e-21    -0.840338410     -184432.963</div>
<div class="line">E_c = -7786.643737</div>
<div class="line"> </div>
<div class="line">Valence: CsI</div>
<div class="line">     state  k   Rinf its   eps         En (au)        En (/cm)   En (/cm)</div>
<div class="line">0   6s_1/2 -1   69.7  1  0e+00    -0.127368053      -27954.056       0.00</div>
<div class="line">1   7s_1/2 -1  109.1  1  0e+00    -0.055187351      -12112.224   15841.83</div>
<div class="line">2   6p_1/2  1   86.1  1  0e+00    -0.085615846      -18790.506    9163.55</div>
<div class="line">3   7p_1/2  1  126.8  1  0e+00    -0.042021373       -9222.625   18731.43</div>
<div class="line">4   6p_3/2 -2   87.0  1  0e+00    -0.083785436      -18388.778    9565.28</div>
<div class="line">5   7p_3/2 -2  127.8  1  0e+00    -0.041368028       -9079.233   18874.82</div>
<div class="line">6   5d_3/2  2  100.3  1  0e+00    -0.064419644      -14138.478   13815.58</div>
<div class="line">7   5d_5/2 -3  100.3  1  0e+00    -0.064529777      -14162.649   13791.41</div>
<div class="line"> </div>
<div class="line">ampsci: T = 742.64 ms</div>
</div><!-- fragment --><p>For calculations that matter, the <em>entire</em> output should be saved. The best way to do this is to forward the output directly to a text file when running the code. The input options and the ampsci version details are also printed, so that the program output contains all required info to exactly reproduce it. A nice way to do this is by <code>piping</code> the output through the unix <code>tee</code> program: e.g.,</p>
<div class="fragment"><div class="line">./ampsci example.in |tee -a example.out</div>
</div><!-- fragment --><ul>
<li>Runs ampsci using input options in file "example.in".</li>
<li>Output will both be written to screen, and <em>appended</em> (due to the <code>-a</code>) to file "example.out".</li>
</ul>
<p>It's important to understand the meaning of the program output. The first part of the output just prints the version information for ampsci. This is important for reproducing old results, which may depend on the ampsci version.</p>
<p>Then, the entire set of input options is printed. This is useful, since it tells you explicitly which calculations were run, and is very useful for catching mistakes and reproducing old calculations. Importantly, the format is exactly what is required on input, so to re-run the calculation, this can simply be copy+pasted into a new input file.</p>
<div class="fragment"><div class="line">Running for Cs, Z=55 A=133</div>
<div class="line">Fermi nucleus;  r_rms = 4.8041, c_hdr = 5.67073, t = 2.3</div>
<div class="line">Log-linear (b=50) grid: 1e-06 -&gt; 150.0, N=3000, du=0.364</div>
</div><!-- fragment --><ul>
<li>This tells you atom and isotope for which the calculations were run, the exact nuclear parameters used (these are for the finite-nuclear size effect), and the exact grid parameters used.</li>
</ul>
<div class="fragment"><div class="line">Hartree-Fock</div>
<div class="line">Core   :  it: 28 eps=6.0e-14 for 4d-</div>
<div class="line">Val    :  it: 38 eps=0.0e+00 for 6s+ [ 38 eps=0e+00 for 6s+]</div>
</div><!-- fragment --><ul>
<li>This is one of the most important outputs to check.</li>
<li>This tells us that Hartree-Fock equations for the core converged to parts in \(10^{14}\) in 28 iterations, and the worst core state convergence was for \(4d_{3/2}\).</li>
<li>A short-hand is often used for states, with \(\pm\) used to denote \(j=l\pm 1/2\)<ul>
<li>e.g., <code>s+</code> = \(s_{1/2}\), <code>p-</code> = \(p_{1/2}\), <code>p+</code> = \(p_{3/2}\), <code>d-</code> = \(d_{3/2}\), and so on</li>
</ul>
</li>
<li>The worst valence state converged to <code>0</code> (i.e., floating point underflowed) in 38 iterations</li>
<li>It's important to check that none of these 'epsilon' values are large (i.e., \(\epsilon\lesssim10^{-6}\)), otherwise it means Hartree-Fock didn't converge properly, and the calculations will be unreliable. This is rarely an issue.</li>
</ul>
<div class="fragment"><div class="line">Cs-133</div>
<div class="line">Core: [Xe] V^N-1</div>
<div class="line">     state  k   Rinf its   eps         En (au)        En (/cm)</div>
<div class="line">0   1s_1/2 -1    0.6  2  3e-26 -1330.118948578  -291927365.908</div>
<div class="line">1   2s_1/2 -1    1.6  2  2e-23  -212.564531454   -46652522.182</div>
<div class="line">2   2p_1/2  1    1.7  2  9e-24  -199.429544822   -43769725.833</div>
<div class="line">3   2p_3/2 -2    1.7  2  1e-23  -186.436652689   -40918115.622</div>
<div class="line">4   3s_1/2 -1    3.5  2  1e-21   -45.969754347   -10089194.889</div>
<div class="line">5   3p_1/2  1    3.7  2  7e-22   -40.448315683    -8877379.174</div>
<div class="line">6   3p_3/2 -2    3.8  2  7e-22   -37.894321340    -8316842.207</div>
<div class="line">7   3d_3/2  2    4.4  2  4e-22   -28.309520221    -6213221.515</div>
<div class="line">8   3d_5/2 -3    4.5  2  5e-22   -27.775176726    -6095946.673</div>
<div class="line">9   4s_1/2 -1    7.7  2  1e-20    -9.512819127    -2087822.471</div>
<div class="line">10  4p_1/2  1    8.7  2  8e-21    -7.446283819    -1634270.396</div>
<div class="line">11  4p_3/2 -2    9.1  2  9e-21    -6.920999546    -1518983.824</div>
<div class="line">12  4d_3/2  2   12.8  2  6e-21    -3.485619407     -765005.034</div>
<div class="line">13  4d_5/2 -3   13.0  2  6e-21    -3.396901914     -745533.795</div>
<div class="line">14  5s_1/2 -1   19.8  2  7e-21    -1.489803443     -326974.062</div>
<div class="line">15  5p_1/2  1   25.7  2  3e-21    -0.907896945     -199260.347</div>
<div class="line">16  5p_3/2 -2   26.7  2  3e-21    -0.840338410     -184432.963</div>
<div class="line">E_c = -7786.643737</div>
</div><!-- fragment --><ul>
<li>This is the output for the core states.</li>
<li>The columns are:<ul>
<li><code>state</code>: which core state</li>
<li><code>k</code>: value of \(\kappa\) (Dirac quantum number) for state</li>
<li><code>Rinf</code>: Radius of the 'practical infinity', i.e., point on the radial grid where that orbital can be safely said to be zero. It's crucial to check all of these values lie well below <code>rmax</code> (set in <code>Grid{}</code>). If these are close to <code>rmax</code>, <code>rmax</code> should be increased.</li>
<li><code>its</code>: Number of iterations it took to solve the single-particle Dirac equation upon the final Hartree-Fock iteration</li>
<li><code>eps</code>: Extent to which the single-particle energy converged when solving the Dirac equation upon the last Hartree-Fock iteration. These numbers should be extremely small; if any are larger, it means there is possibly a serious numerical error. Normally, these will always be fine, so long as Hartree-Fock converged</li>
<li><code>En (au)</code> and <code>En (/cm)</code> are the single-particle (binding) energies in atomic units and \({\rm cm}^{-1}\), respectively. Atomic unit for energy is the Hartree: \(E_h = 2 Ry = \frac{\hbar^2}{m_e a_0^2} \approx 27.2\,{\rm eV}\).</li>
<li>The final number <code>E_c</code> is the total Hartree-Fock energy of the core, in atomic units</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line">Valence: CsI</div>
<div class="line">     state  k   Rinf its   eps         En (au)        En (/cm)   En (/cm)</div>
<div class="line">0   6s_1/2 -1   69.7  1  0e+00    -0.127368053      -27954.056       0.00</div>
<div class="line">1   7s_1/2 -1  109.1  1  0e+00    -0.055187351      -12112.224   15841.83</div>
<div class="line">2   6p_1/2  1   86.1  1  0e+00    -0.085615846      -18790.506    9163.55</div>
<div class="line">3   7p_1/2  1  126.8  1  0e+00    -0.042021373       -9222.625   18731.43</div>
<div class="line">4   6p_3/2 -2   87.0  1  0e+00    -0.083785436      -18388.778    9565.28</div>
<div class="line">5   7p_3/2 -2  127.8  1  0e+00    -0.041368028       -9079.233   18874.82</div>
<div class="line">6   5d_3/2  2  100.3  1  0e+00    -0.064419644      -14138.478   13815.58</div>
<div class="line">7   5d_5/2 -3  100.3  1  0e+00    -0.064529777      -14162.649   13791.41</div>
</div><!-- fragment --><ul>
<li>Finally, we have the output for the valence states</li>
<li>Most of these are the same as above, except there is an extra column, which gives the excitation energies (in \({\rm cm}^{-1}\)) relative to the lowest valence state (useful for comparing with <a href="https://physics.nist.gov/PhysRefData/ASD/levels_form.html">NIST database</a>)</li>
</ul>
<p>To do more complicated calculations, including constructing complete set of basis orbitals, and including core-valence correlations, see:</p>
<ul>
<li><a href="https://ampsci.dev/ampsci.pdf">ampsci.pdf</a> for full physics description of what the code can do</li>
</ul>
<hr  />
<h1>Modules: using the wavefunctions <a class="anchor" id="modules"></a></h1>
<p>The general usage of the code is to first use the main blocks to construct the atomic wavefunction and basis states, then to add as many 'Module::' blocks as required. Each module is a separate routine that will take the calculated wavefunction and compute any desired property (e.g., matrix elements). The code is designed such that anyone can write a new Module (See <a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2writing__modules.html">doc/writing_modules.md</a>)</p>
<p>Above, we ran ampsci, which calculated the atomic wavefunctions and printed their energies to screen. If we want to actually <em>do</em> anything with the wavefunctions, we have to run one or more <b>modules</b>. We do this by adding a module block to the input file, which has the form <code>Module::ModuleName{}</code></p>
<p>Here, we will just consider a simple example. For further detail:</p>
<ul>
<li>See <a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2modules.html">doc/modules.md</a> for details of currently avalable modules</li>
<li>The code is designed so that you can easily create your own modules. See <a class="el" href="md__2home_2runner_2work_2ampsci_2ampsci_2doc_2writing__modules.html">doc/writing_modules.md</a> for details</li>
</ul>
<p>We can see a list of all available modules with the <code>-m</code> command-line option</p>
<div class="fragment"><div class="line">./ampsci -m</div>
</div><!-- fragment --><p>Many are listed. Here we will consider the simple/common example of <code>matrixElements</code> module, which (unsurprisingly) calculates matrix elements.</p>
<p>To see the available options for this block, list the block name after <code>-m</code> on the command-line:</p>
<div class="fragment"><div class="line">./ampsci -m matrixElements</div>
</div><!-- fragment --><p>which prints:</p>
<div class="fragment"><div class="line"><span class="comment">// Available Module::matrixElements options/blocks</span></div>
<div class="line"><a class="code hl_function" href="namespaceModule.html#aad4d284d8f72582faa35e991c685c9b5">Module::matrixElements</a>{</div>
<div class="line">  <span class="comment">// e.g., E1, hfs (see ampsci -o for available operators)</span></div>
<div class="line">  operator;</div>
<div class="line">  <span class="comment">// options specific to operator (see ampsci -o &#39;operator&#39;)</span></div>
<div class="line">  options{}</div>
<div class="line">  <span class="comment">// Method used for RPA: true(=TDHF), false, TDHF, basis, diagram [true]</span></div>
<div class="line">  rpa;</div>
<div class="line">  <span class="comment">// Text or number. Freq. for RPA (and freq. dependent operators). Put &#39;each&#39;</span></div>
<div class="line">  <span class="comment">// to solve at correct frequency for each transition. [0.0]</span></div>
<div class="line">  omega;</div>
<div class="line">  <span class="comment">// What to calculate: rme (reduced ME), A (hyperfine A/B coeficient). Default</span></div>
<div class="line">  <span class="comment">// is rme, except when operator=hfs, in which case default is A</span></div>
<div class="line">  what;</div>
<div class="line">  <span class="comment">// print &lt;a|h|b&gt; and &lt;b|h|a&gt; [false]</span></div>
<div class="line">  printBoth;</div>
<div class="line">  <span class="comment">// If true (and spectrum available), will use spectrum for valence states AND</span></div>
<div class="line">  <span class="comment">// for RPA (if diagram method), AND for SR+N [false]</span></div>
<div class="line">  use_spectrum;</div>
<div class="line">  <span class="comment">// Calculate diagonal matrix elements (if non-zero) [true]</span></div>
<div class="line">  diagonal;</div>
<div class="line">  <span class="comment">// Calculate off-diagonal matrix elements (if non-zero) [true]</span></div>
<div class="line">  off-diagonal;</div>
<div class="line">  <span class="comment">// Options for Structure Radiation and normalisation (details below)</span></div>
<div class="line">  StructureRadiation{}</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Available StructureRadiation options/blocks</span></div>
<div class="line">StructureRadiation{</div>
<div class="line">  <span class="comment">// If this block is included, SR + Normalisation corrections will be included</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// filename for QkTable file. If blank will not use QkTable; if exists, will</span></div>
<div class="line">  <span class="comment">// read it in; if doesn&#39;t exist, will create it and write to disk. Save time</span></div>
<div class="line">  <span class="comment">// (10x) at cost of memory. Note: Using QkTable implies splines used for</span></div>
<div class="line">  <span class="comment">// diagram legs</span></div>
<div class="line">  Qk_file;</div>
<div class="line">  <span class="comment">// list; min,max n for core/excited: [1,inf]</span></div>
<div class="line">  n_minmax;</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceModule_html_aad4d284d8f72582faa35e991c685c9b5"><div class="ttname"><a href="namespaceModule.html#aad4d284d8f72582faa35e991c685c9b5">Module::matrixElements</a></div><div class="ttdeci">void matrixElements(const IO::InputBlock &amp;input, const Wavefunction &amp;wf)</div><div class="ttdoc">Calculates matrix elements of any tensor operator, with RPA.</div><div class="ttdef"><b>Definition</b> matrixElements.cpp:31</div></div>
</div><!-- fragment --><p>The first option, <code>operator</code> is which operator we want to calculate matrix elements of. You can see a list of operators with the <code>-o</code> command-line option:</p>
<div class="fragment"><div class="line">./ampsci -o</div>
</div><!-- fragment --><p>The second option, which is a sub-input-block, <code>options</code> is the set of options for the given operator. Most operators have no extra options, so this can be left blank. Some (e.g., hyperfine operator <code>hfs</code> have many available options). Like above, you can see the available options by further passing the operator name after <code>-o</code>. For example:</p>
<div class="fragment"><div class="line">./ampsci -o hfs</div>
</div><!-- fragment --><p>Here we will consider the simpler <code>E1</code> operator. To our above <code>example.in</code> file, we can add the following block (note we may add as many Module:: blocks as we like, they will all be run one-by-one in order):</p>
<div class="fragment"><div class="line"><span class="comment">// example.in</span></div>
<div class="line"><span class="comment">// ... above input options ...</span></div>
<div class="line">Module::Matrixelements{</div>
<div class="line">  operator = E1;</div>
<div class="line">  rpa = <span class="keyword">true</span>;</div>
<div class="line">  omega = 0.0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The <code>omega = 0.0;</code> option means we have solved RPA equations for each transition at zero frequency. It is also possible to automatically solve RPA for each transition frequency by setting: <code>omega = each;</code>. See <a href="https://ampsci.dev/ampsci.pdf">ampsci.pdf</a> for description of RPA.</p>
<p>The output format will depend on the specific module. In this case, we are shown the extent to which the RPA (/TDHF) equations converged, and then the valued of the reduced matrix elements are printed (at the Hartree-Fock, first-order core-polarisation, and all-orders RPA levels) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 27 2025 01:28:43 for ampsci by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
