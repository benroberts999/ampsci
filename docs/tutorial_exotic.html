<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="light-mode">
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
        <meta name="generator" content="Doxygen 1.9.8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ampsci:
            Exotic atoms</title>
        <link href="tabs.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="blue-theme.css" rel="stylesheet" type="text/css"/>
        <!-- ... other metadata & script includes ... -->
        <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
        <script type="text/javascript">
            DoxygenAwesomeFragmentCopyButton.init()
        </script>
        <!-- <script>
            document.documentElement.classList.add("light-mode");
        </script> -->
    </head>
    <body>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div id="titlearea">
                <table cellspacing="0" cellpadding="0">
                    <tbody>
                        <tr style="height: 56px;">
                            <td id="projectalign" style="padding-left: 0.5em;">
                                <div id="projectname">ampsci
                                </div>
                                <div
                                    id="projectbrief">High-precision calculations for one- and two-valence atomic systems</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('tutorial_exotic.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Exotic atoms</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Calculations for exotic atoms (e.g., muonic)</p>
<p>This assumes you already have ampsci compiled and have a basic understanding of how to run and use it.</p>
<ul>
<li>See <a class="el" href="compilation.html">Compilation</a> for compilation instructions</li>
<li>See <a class="el" href="tutorial_basic.html">Basic Tutorial</a> for getting started if unfamiliar</li>
</ul>
<h2>Starting point</h2>
<p>At a minimum, you must set the <code>Atom</code>, <code>Grid</code> and <code>Exotic</code> blocks:</p>
<p>For example:</p>
<div class="fragment"><div class="line">Atom {</div>
<div class="line">  Z = Cs;</div>
<div class="line">  A = 133;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classGrid.html">Grid</a> {</div>
<div class="line">  r0 = 1e-8;</div>
<div class="line">  rmax = 1.0;</div>
<div class="line">  num_points = 4000;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">Exotic {</div>
<div class="line">  states = 3sp;</div>
<div class="line">}</div>
<div class="ttc" id="aclassGrid_html"><div class="ttname"><a href="classGrid.html">Grid</a></div><div class="ttdoc">Holds grid, including type + Jacobian (dr/du)</div><div class="ttdef"><b>Definition</b> Grid.hpp:31</div></div>
</div><!-- fragment --><p>The optional <code>Nucleus</code> block allows you to set nuclear charge distribution parameters. If not set, defaults (based on Z,A) will be used. Uses Fermi distribution with charge radii from Angeli tables by default.</p>
<p>Note:</p>
<ul>
<li>Use <code>ampsci -i</code> to see a list of available input blocks</li>
<li>And, for example, <code>ampsci -i Exotic</code> to see list of options for 'Exotic' block</li>
</ul>
<p>With the above options in text file <code>input_file.in</code>, run as: <code>./ampsci input_file.in</code></p>
<p>Output should be:</p>
<div class="fragment"><div class="line">Running for Cs, Z=55 A=133</div>
<div class="line">Fermi nucleus;  r_rms = 4.8041, c_hdr = 5.67073, t = 2.3</div>
<div class="line">Loglinear (b=0.333333) grid: 1e-08 -&gt; 1.0, N=4000, du=0.00179</div>
<div class="line">========================================================</div>
<div class="line"> </div>
<div class="line">Cs-133</div>
<div class="line">Core: [] V^N-55 - H-like</div>
<div class="line">E_c = 0.000000</div>
<div class="line"> </div>
<div class="line">---------------------------------------------</div>
<div class="line">Exotic Cs</div>
<div class="line">M = 206.76828270 m_e = 105.658375496267 MeV</div>
<div class="line"> </div>
<div class="line">Energies - without screening:</div>
<div class="line">nk    Rinf  eps    R_rms (a0)    E (au)            E (keV)</div>
<div class="line">1s+   0.05  1e-16  2.08947e-04  -2.205529115e+05  -6.001550463e+03</div>
<div class="line">2s+   0.09  9e-15  6.65035e-04  -6.648031490e+04  -1.809021527e+03</div>
<div class="line">3s+   0.13  4e-15  1.39951e-03  -3.131039258e+04  -8.519991861e+02</div>
<div class="line">2p-   0.08  1e-15  4.65662e-04  -8.038004543e+04  -2.187252463e+03</div>
<div class="line">3p-   0.13  3e-15  1.15009e-03  -3.554126473e+04  -9.671270822e+02</div>
<div class="line">2p+   0.08  2e-15  4.81379e-04  -7.813279599e+04  -2.126101690e+03</div>
<div class="line">3p+   0.13  2e-16  1.17161e-03  -3.492090173e+04  -9.502461450e+02</div>
</div><!-- fragment --><ul>
<li>nk is state (+/- means j+/-1/2), p- = p_1/2, p+=p_3/2 etc.</li>
<li>Rinf radius where wavefunction effectively goes to zero. Should be smaller than rmax from the Grid.</li>
<li>eps - convergence parameter for solcing eigenvalue problem. Check carefully - should be very small number &lt;~10^-11</li>
<li>R_rms - the rms radius for this state. Helpful for determining reasonable grid parameters</li>
<li>E - binding energy, in atomic units (Hartree) and keV</li>
</ul>
<p>Hint: use <code>ampsci -c</code> from command line to get useful unit conversions. Even better: try these out for actual conversions: &lsquo;ampsci -c 5 keV&rsquo; &lsquo;ampsci -c 200 nm&rsquo;</p>
<h2>Important: Making sure the Grid settings are OK</h2>
<p>Very important to choose a Grid that actually works. In the end, you should always check that making small changes to the grid does not impact the result.</p>
<ul>
<li>The first way to make sure Grid is OK is to check 'Rinf' (that your wavefunctions all fit inside the grid radius).</li>
<li>More importantly, check 'eps':</li>
</ul>
<p>For example, with this Grid:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classGrid.html">Grid</a> {</div>
<div class="line">  r0 = 1e-7;</div>
<div class="line">  rmax = 10.0;</div>
<div class="line">  num_points = 3000;</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">Energies - without screening:</div>
<div class="line">nk    Rinf  eps    R_rms (a0)    E (au)            E (keV)</div>
<div class="line">1s+   0.05  7e-15  2.08947e-04  -2.205529117e+05  -6.001550468e+03</div>
<div class="line">2s+   0.09  4e-15  6.65035e-04  -6.648031492e+04  -1.809021527e+03</div>
<div class="line">3s+   0.13  1e-04  1.50559e-03  -3.131393670e+04  -8.520956264e+02</div>
<div class="line">2p-   0.08  4e-16  4.65662e-04  -8.038004540e+04  -2.187252462e+03</div>
<div class="line">3p-   0.12  1e-15  1.15009e-03  -3.554126472e+04  -9.671270819e+02</div>
<div class="line">2p+   0.08  1e-15  4.81379e-04  -7.813279599e+04  -2.126101690e+03</div>
<div class="line">3p+   0.13  0e+00  1.17161e-03  -3.492090173e+04  -9.502461450e+02</div>
</div><!-- fragment --><p>Everything is OK except for '3s+', which only converged to '1e-04'.</p>
<p>Using a more reasonable Grid (you can make educated guess, but best bet is usually trial+error):</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classGrid.html">Grid</a> {</div>
<div class="line">  r0 = 1e-8;</div>
<div class="line">  rmax = 1.0;</div>
<div class="line">  num_points = 4000;</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">Energies - without screening:</div>
<div class="line">nk    Rinf  eps    R_rms (a0)    E (au)            E (keV)</div>
<div class="line">1s+   0.05  1e-16  2.08947e-04  -2.205529115e+05  -6.001550463e+03</div>
<div class="line">2s+   0.09  9e-15  6.65035e-04  -6.648031490e+04  -1.809021527e+03</div>
<div class="line">3s+   0.13  4e-15  1.39951e-03  -3.131039258e+04  -8.519991861e+02</div>
<div class="line">2p-   0.08  1e-15  4.65662e-04  -8.038004543e+04  -2.187252463e+03</div>
<div class="line">3p-   0.13  3e-15  1.15009e-03  -3.554126473e+04  -9.671270822e+02</div>
<div class="line">2p+   0.08  2e-15  4.81379e-04  -7.813279599e+04  -2.126101690e+03</div>
<div class="line">3p+   0.13  2e-16  1.17161e-03  -3.492090173e+04  -9.502461450e+02</div>
</div><!-- fragment --><h2>Include effect of electron screening</h2>
<p>Can add a Hartree-Fock block to include electrons alongside the muon</p>
<div class="fragment"><div class="line">HartreeFock {</div>
<div class="line">  core = [Xe];</div>
<div class="line">}</div>
</div><!-- fragment --><p>This will solve Hartree-Fock for the electrons in core configuration 'Xe', for example. Must have fewer electrons than Z to converge (since there will also be a muon). In reality, atom is usually very ionised, so probably <code>[He]</code> or someting more reasonable. Both effects are accounted for: impact of muon on electrons, and impact of electrons on the muon. Due to radius of their respective orbits, the effect of screening on the muon is very small. (Effect of muon on electrons is not small - it essentially subtracts 1 from Z!)</p>
<p>Note: The same 'Grid' is used for both the electron and muon parts of the problem. Therefore, you will need quite a large grid for this to work well. For example:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classGrid.html">Grid</a> {</div>
<div class="line">  r0 = 1e-8;</div>
<div class="line">  rmax = 50.0; <span class="comment">// accomodate electron _and_ muons</span></div>
<div class="line">  num_points = 20000;</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">Energies - without screening:</div>
<div class="line">nk    Rinf  eps    R_rms (a0)    E (au)            E (keV)</div>
<div class="line">1s+   0.05  2e-15  2.08947e-04  -2.205529115e+05  -6.001550463e+03</div>
<div class="line">2s+   0.09  2e-16  6.65035e-04  -6.648031490e+04  -1.809021527e+03</div>
<div class="line">3s+   0.13  5e-16  1.39951e-03  -3.131039258e+04  -8.519991861e+02</div>
<div class="line">2p-   0.08  4e-16  4.65662e-04  -8.038004543e+04  -2.187252463e+03</div>
<div class="line">3p-   0.13  6e-16  1.15009e-03  -3.554126473e+04  -9.671270822e+02</div>
<div class="line">2p+   0.08  1e-15  4.81379e-04  -7.813279599e+04  -2.126101690e+03</div>
<div class="line">3p+   0.13  2e-15  1.17161e-03  -3.492090173e+04  -9.502461450e+02</div>
<div class="line"> </div>
<div class="line">....</div>
<div class="line"> </div>
<div class="line">Exotic energies - with screening:</div>
<div class="line">nk    Rinf  eps    R_rms (a0)    E (au)            E (keV)</div>
<div class="line">1s+   0.05  7e-16  2.08947e-04  -2.202175480e+05  -5.992424758e+03</div>
<div class="line">2s+   0.09  1e-15  6.65037e-04  -6.614512626e+04  -1.799900579e+03</div>
<div class="line">3s+   0.13  8e-16  1.39953e-03  -3.097576144e+04  -8.428934089e+02</div>
<div class="line">2p-   0.08  2e-15  4.65663e-04  -8.004476127e+04  -2.178128916e+03</div>
<div class="line">3p-   0.13  9e-15  1.15011e-03  -3.520640973e+04  -9.580152136e+02</div>
<div class="line">2p+   0.08  2e-16  4.81380e-04  -7.779751836e+04  -2.116978321e+03</div>
<div class="line">3p+   0.13  4e-16  1.17163e-03  -3.458606467e+04  -9.411347644e+02</div>
</div><!-- fragment --><p>So, small, but noticable impact.</p>
<h2>Matrix elements, hyperfine structure, anomaly</h2>
<ul>
<li>Use <code>ampsci -o</code> to get the list of available operators</li>
<li>And, for example, <code>ampsci -o hfs</code> to see all options for the hfs operator</li>
</ul>
<p>Can simple calculate matrix elements of any operator:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="namespaceModule.html#aad4d284d8f72582faa35e991c685c9b5">Module::matrixElements</a>{</div>
<div class="line">  operator = hfs;</div>
<div class="line">  options{</div>
<div class="line">    <span class="comment">// magnetisation distribution model:</span></div>
<div class="line">    F = ball;</div>
<div class="line">    <span class="comment">// magnetic rms radius:</span></div>
<div class="line">    rrms = 7.0; <span class="comment">// by default, will be same as charge rms</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Note: rpa (many-body corrections)</span></div>
<div class="line">  <span class="comment">// will run for muonic atoms, but is completely meaningless</span></div>
<div class="line">  rpa = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  off-diagonal = <span class="keyword">false</span>;</div>
<div class="line">  diagonal = <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceModule_html_aad4d284d8f72582faa35e991c685c9b5"><div class="ttname"><a href="namespaceModule.html#aad4d284d8f72582faa35e991c685c9b5">Module::matrixElements</a></div><div class="ttdeci">void matrixElements(const IO::InputBlock &amp;input, const Wavefunction &amp;wf)</div><div class="ttdoc">Calculates matrix elements of any tensor operator, with RPA.</div><div class="ttdef"><b>Definition</b> matrixElements.cpp:31</div></div>
</div><!-- fragment --><p><b>NOTE</b> always set rpa=false (or ignore the rpa output) for muonic atoms. RPA is a many-body correction. The code calculates this for muons, even though it shouldn't. It's meaningless for muons, and will not converge. Results mean nothing.</p>
<p>There's als a module specificly for hyperfine anomaly. It just calculates matrix elements twice, one for pointlike, and takes ratio.</p>
<div class="fragment"><div class="line">Module::hfAnomaly {</div>
<div class="line">  <span class="comment">// same options as hfs operator</span></div>
<div class="line">  hfs_options{</div>
<div class="line">    F = ball;</div>
<div class="line">    rrms = 7.0;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials and Examples</a></li>
    <li class="footer">Generated on Mon Mar 2 2026 04:48:12 for ampsci by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
