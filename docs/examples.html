<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="light-mode">
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
        <meta name="generator" content="Doxygen 1.9.8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>ampsci:
            Basic Usage and Example</title>
        <link href="tabs.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="blue-theme.css" rel="stylesheet" type="text/css"/>
        <!-- ... other metadata & script includes ... -->
        <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
        <script type="text/javascript">
            DoxygenAwesomeFragmentCopyButton.init()
        </script>
        <!-- <script>
            document.documentElement.classList.add("light-mode");
        </script> -->
    </head>
    <body>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div id="titlearea">
                <table cellspacing="0" cellpadding="0">
                    <tbody>
                        <tr style="height: 56px;">
                            <td id="projectalign" style="padding-left: 0.5em;">
                                <div id="projectname">ampsci
                                </div>
                                <div
                                    id="projectbrief">High-precision calculations for one- and two-valence atomic systems</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('examples.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Basic Usage and Example</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A few very basic examples.</p>
<p>Here is a very breif introduction to running ampsci with an example input file. See the <a class="el" href="tutorials.html">detailed tutorials</a> for more.</p>
<h2>Input options, self-deocumentation</h2>
<p>Typically, ampsci will be run taking input from a plain text input file (in this case, called <code>example.in</code>):</p>
<div class="fragment"><div class="line">./ampsci example.in</div>
</div><!-- fragment --><p>There are many input options available. We can use the code to tell us which input options are available using the <code>-i</code> (or <code>--ampsci</code>) command-line option. For example, try:</p>
<div class="fragment"><div class="line">./ampsci -i</div>
<div class="line">./ampsci -i HartreeFock</div>
</div><!-- fragment --><p>which should output:</p>
<div class="fragment"><div class="line"><span class="comment">// Available ampsci options/blocks</span></div>
<div class="line">ampsci{</div>
<div class="line">  <span class="comment">// These are the top-level ampsci input blocks and options. Default values are</span></div>
<div class="line">  <span class="comment">// given in square brackets following the description: [default_value]. Blocks</span></div>
<div class="line">  <span class="comment">// end with &#39;{}&#39;, options end with &#39;;&#39;. run `ampsci -i BlockName` (for any of</span></div>
<div class="line">  <span class="comment">// the following blocks) to see all the options available for that block.</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Which atom to run for</span></div>
<div class="line">  Atom{}</div>
<div class="line">  <span class="comment">// Set nuclear parameters</span></div>
<div class="line">  Nucleus{}</div>
<div class="line">  <span class="comment">// Set radial grid/lattice parameters</span></div>
<div class="line">  <a class="code hl_class" href="classGrid.html">Grid</a>{}</div>
<div class="line">  <span class="comment">// Options for solving atomic system</span></div>
<div class="line">  HartreeFock{}</div>
<div class="line">  <span class="comment">// Options for the QED radiative potential (usually defaults suffice)</span></div>
<div class="line">  RadPot{}</div>
<div class="line">  <span class="comment">// Include an extra effective potential. Rarely used.</span></div>
<div class="line">  ExtraPotential{}</div>
<div class="line">  <span class="comment">// Basis of HF eigenstates used for MBPT</span></div>
<div class="line">  Basis{}</div>
<div class="line">  <span class="comment">// Options for MBPT and correlation corrections</span></div>
<div class="line">  Correlations{}</div>
<div class="line">  <span class="comment">// Like basis, but includes correlations. Used for sum-over-states</span></div>
<div class="line">  Spectrum{}</div>
<div class="line">  <span class="comment">// Option for including `exotic` (e.g., muonic) atom states.</span></div>
<div class="line">  Exotic{}</div>
<div class="line">  <span class="comment">// Configuration Interaction</span></div>
<div class="line">  <a class="code hl_namespace" href="namespaceCI.html">CI</a>{}</div>
<div class="line">  <span class="comment">// Run any number of modules (* -&gt; module name). `ampsci -m` to see available</span></div>
<div class="line">  <span class="comment">// modules</span></div>
<div class="line">  <a class="code hl_namespace" href="namespaceModule.html">Module</a>::*{}</div>
<div class="line">}</div>
<div class="ttc" id="aclassGrid_html"><div class="ttname"><a href="classGrid.html">Grid</a></div><div class="ttdoc">Holds grid, including type + Jacobian (dr/du)</div><div class="ttdef"><b>Definition</b> Grid.hpp:31</div></div>
<div class="ttc" id="anamespaceCI_html"><div class="ttname"><a href="namespaceCI.html">CI</a></div><div class="ttdoc">Functions and classes for Configuration Interaction calculations.</div><div class="ttdef"><b>Definition</b> CI_Integrals.cpp:11</div></div>
<div class="ttc" id="anamespaceModule_html"><div class="ttname"><a href="namespaceModule.html">Module</a></div><div class="ttdoc">Modules are run using calculated atomic wavefunctions.</div><div class="ttdef"><b>Definition</b> Module_Kionisation.cpp:47</div></div>
</div><!-- fragment --><p>and</p>
<div class="fragment"><div class="line"><span class="comment">// Available HartreeFock options/blocks</span></div>
<div class="line">HartreeFock{</div>
<div class="line">  <span class="comment">// Options for solving lowest-order atomic wavefunction</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Core configuration. Either list entire core, or use [At] short-hand. e.g.,</span></div>
<div class="line">  <span class="comment">// [He] equivilant to 1s2; [Xe],6s1 equivilant to [Cs] and to</span></div>
<div class="line">  <span class="comment">// 1s2,2s2,...,5p6,6s1. Instead of one of the commas, you may use a &#39;:&#39; -</span></div>
<div class="line">  <span class="comment">// states above this are included into the core, but not excluded from the</span></div>
<div class="line">  <span class="comment">// valence list. Use this method for KohnSham, for example. [blank by default]</span></div>
<div class="line">  core;</div>
<div class="line">  <span class="comment">// Valence configuration in `basis string&#39; format. e.g., 7sp5df will include</span></div>
<div class="line">  <span class="comment">// valence states up to  n=7 for s and p, and up to n=5 for d and f states.</span></div>
<div class="line">  <span class="comment">// Automatically excludes states in the core (except those above the optional</span></div>
<div class="line">  <span class="comment">// &#39;:&#39;). [blank by default]</span></div>
<div class="line">  valence;</div>
<div class="line">  <span class="comment">// HF convergance goal [1.0e-13]</span></div>
<div class="line">  eps;</div>
<div class="line">  <span class="comment">// Method for mean-field approximation: HartreeFock, Hartree, KohnSham, Local</span></div>
<div class="line">  <span class="comment">// [HartreeFock]</span></div>
<div class="line">  method;</div>
<div class="line">  <span class="comment">// Include Breit into HF? true/false, or scale factor. Scale factor for Breit</span></div>
<div class="line">  <span class="comment">// Hamiltonian is usially 0.0 (no Breit) or 1.0 (full Breit), but can take any</span></div>
<div class="line">  <span class="comment">// value. [false]</span></div>
<div class="line">  Breit;</div>
<div class="line">  <span class="comment">// Include QED? Three options: true, false, valence. If &#39;valence, will include</span></div>
<div class="line">  <span class="comment">// QED only into valence states, but not the core. Detailed QED options are</span></div>
<div class="line">  <span class="comment">// set within the RadPot{} block - if that block is not set, defaults will be</span></div>
<div class="line">  <span class="comment">// used. By default, this option is false, unless the RadPot{} block exists,</span></div>
<div class="line">  <span class="comment">// in which case it is true</span></div>
<div class="line">  QED;</div>
<div class="line">}</div>
</div><!-- fragment --><p>respectively</p>
<h2>Basic example</h2>
<ul>
<li>Here's one basic example</li>
<li>Several other are provided with the code in <code>doc/examples/</code></li>
</ul>
<div class="fragment"><div class="line">Atom {</div>
<div class="line">  Z = Cs;</div>
<div class="line">  A = 133;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HartreeFock {</div>
<div class="line">  core = [Xe];</div>
<div class="line">  valence = 7sp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classGrid.html">Grid</a> {</div>
<div class="line">  r0 = 1e-6;</div>
<div class="line">  rmax = 120.0;</div>
<div class="line">  num_points = 2000;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// E1 matrix elements, including RPA (TDHF method, solved at w=0)</span></div>
<div class="line"><a class="code hl_function" href="namespaceModule.html#aad4d284d8f72582faa35e991c685c9b5">Module::matrixElements</a> {</div>
<div class="line">  operator = E1;</div>
<div class="line">  rpa = TDHF;</div>
<div class="line">  omega = 0.0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Calculate hyperfine matrix elements</span></div>
<div class="line"><a class="code hl_function" href="namespaceModule.html#aad4d284d8f72582faa35e991c685c9b5">Module::matrixElements</a> {</div>
<div class="line">  operator = hfs;</div>
<div class="line">  off-diagonal = <span class="keyword">false</span>; <span class="comment">// only the diagonal matrix elements</span></div>
<div class="line">  options{</div>
<div class="line">      F = pointlike;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceModule_html_aad4d284d8f72582faa35e991c685c9b5"><div class="ttname"><a href="namespaceModule.html#aad4d284d8f72582faa35e991c685c9b5">Module::matrixElements</a></div><div class="ttdeci">void matrixElements(const IO::InputBlock &amp;input, const Wavefunction &amp;wf)</div><div class="ttdoc">Calculates matrix elements of any tensor operator, with RPA.</div><div class="ttdef"><b>Definition</b> matrixElements.cpp:31</div></div>
</div><!-- fragment --><p>The output should look something like:</p>
<div class="fragment"><div class="line">Running for Cs, Z=55 A=133</div>
<div class="line">Fermi nucleus;  r_rms = 4.8041, c_hdr = 5.67073, t = 2.3</div>
<div class="line">Loglinear (b=40) grid: 1e-06 -&gt; 120.0, N=2000, du=0.432</div>
<div class="line">========================================================</div>
<div class="line">Hartree-Fock</div>
<div class="line">Core   :  it: 28 eps=8.8e-14 for 5p-</div>
<div class="line">Val    :  it: 38 eps=0.0e+00 for 6s+ [ 38 eps=0e+00 for 6s+]</div>
<div class="line"> </div>
<div class="line">Cs-133</div>
<div class="line">Core: [Xe] V^N-1</div>
<div class="line">#  nk   r_rms  Rinf    eps          En (au)         En (/cm)</div>
<div class="line">0  1s+   0.03   0.6  7e-25  -1330.119222417   -291927426.008</div>
<div class="line">1  2s+   0.12   1.6  4e-22   -212.564636008    -46652545.129</div>
<div class="line">2  2p-   0.10   1.7  2e-22   -199.429666779    -43769752.599</div>
<div class="line">3  2p+   0.11   1.7  3e-22   -186.436769887    -40918141.343</div>
<div class="line">4  3s+   0.32   3.5  2e-20    -45.969772036    -10089198.771</div>
<div class="line">5  3p-   0.31   3.7  2e-20    -40.448337479     -8877383.958</div>
<div class="line">6  3p+   0.32   3.8  2e-20    -37.894342931     -8316846.946</div>
<div class="line">7  3d-   0.29   4.4  1e-20    -28.309546081     -6213227.190</div>
<div class="line">8  3d+   0.30   4.5  1e-20    -27.775202576     -6095952.346</div>
<div class="line">9  4s+   0.74   7.7  3e-19     -9.512815190     -2087821.607</div>
<div class="line">10 4p-   0.77   8.7  2e-19     -7.446281887     -1634269.972</div>
<div class="line">11 4p+   0.80   9.0  2e-19     -6.920996585     -1518983.174</div>
<div class="line">12 4d-   0.90  12.8  1e-19     -3.485619405      -765005.034</div>
<div class="line">13 4d+   0.91  13.0  1e-19     -3.396901664      -745533.740</div>
<div class="line">14 5s+   1.88  19.9  1e-19     -1.489800625      -326973.443</div>
<div class="line">15 5p-   2.15  25.7  6e-20     -0.907895439      -199260.017</div>
<div class="line">16 5p+   2.25  26.7  6e-20     -0.840336747      -184432.598</div>
<div class="line">E_c = -7786.640563</div>
<div class="line"> </div>
<div class="line">Valence: CsI</div>
<div class="line">#  nk    r_rms   Rinf    eps        En (au)       En (/cm)       En (/cm)</div>
<div class="line">0  6s+    6.52   69.6  0e+00   -0.127368022     -27954.050          0.000</div>
<div class="line">1  7s+   14.58  109.1  0e+00   -0.055187338     -12112.221      15841.829</div>
<div class="line">2  6p-    8.65   86.1  0e+00   -0.085615790     -18790.494       9163.556</div>
<div class="line">3  7p-   18.16  120.0  0e+00   -0.042021354      -9222.621      18731.429</div>
<div class="line">4  6p+    8.86   87.0  0e+00   -0.083785371     -18388.763       9565.286</div>
<div class="line">5  7p+   18.47  120.0  0e+00   -0.041368005      -9079.228      18874.822</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">Module: Module::matrixElements</div>
<div class="line"> </div>
<div class="line">Matrix Elements - Operator: E1</div>
<div class="line">Reduced matrix elements</div>
<div class="line">Units: |e|aB</div>
<div class="line">Including RPA: TDHF method</div>
<div class="line">TDHF E1 (w=0.0000): 18 4.8e-11 [3p+,d-]</div>
<div class="line"> </div>
<div class="line">E1</div>
<div class="line"> </div>
<div class="line">   a    b    w_ab        t0_ab          +RPA </div>
<div class="line"> 6p-  6s+    0.0417522  -5.277688e+00  -4.974363e+00</div>
<div class="line"> 7p-  6s+    0.0853467  -3.717428e-01  -2.387087e-01</div>
<div class="line"> 6p+  6s+    0.0435827   7.426436e+00   7.013022e+00</div>
<div class="line"> 7p+  6s+    0.0860000   6.947454e-01   5.087232e-01</div>
<div class="line"> 6p-  7s+   -0.0304285   4.413150e+00   4.449380e+00</div>
<div class="line"> 7p-  7s+    0.0131660  -1.100887e+01  -1.092105e+01</div>
<div class="line"> 6p+  7s+   -0.0285980  -6.671033e+00  -6.712242e+00</div>
<div class="line"> 7p+  7s+    0.0138193   1.534479e+01   1.522742e+01</div>
<div class="line"> </div>
<div class="line">matrixElements: T = 4.30 s</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">Module: Module::matrixElements</div>
<div class="line"> </div>
<div class="line">Hyperfine structure: Cs, Z=55 A=133</div>
<div class="line">K=1 (magnetic dipole)</div>
<div class="line">Using pointlike nuclear distro for F(r)</div>
<div class="line">w/ r_N = 0fm = 0au  (r_rms=0fm)</div>
<div class="line">Points inside nucleus: 0</div>
<div class="line">mu = 2.5778, I = 3.5, g = 0.736514</div>
<div class="line"> </div>
<div class="line">Matrix Elements - Operator: hfs1</div>
<div class="line">Hyperfine constants (magnetic type), K=1</div>
<div class="line">Units: MHz</div>
<div class="line">Including RPA: TDHF method</div>
<div class="line">TDHF hfs1 (w=0.0000): 28 3.3e-09 [4d-,s+]</div>
<div class="line"> </div>
<div class="line">hfs1</div>
<div class="line"> </div>
<div class="line">   a    b    w_ab        t0_ab          +RPA </div>
<div class="line"> 6s+  6s+    0.0000000   1.431372e+03   1.725280e+03</div>
<div class="line"> 7s+  7s+    0.0000000   3.933064e+02   4.732411e+02</div>
<div class="line"> 6p-  6p-    0.0000000   1.607591e+02   2.012689e+02</div>
<div class="line"> 7p-  7p-    0.0000000   5.755954e+01   7.153063e+01</div>
<div class="line"> 6p+  6p+    0.0000000   2.387758e+01   4.276946e+01</div>
<div class="line"> 7p+  7p+    0.0000000   8.625730e+00   1.533316e+01</div>
<div class="line"> </div>
<div class="line">matrixElements: T = 4.88 s</div>
<div class="line"> </div>
<div class="line">ampsci: T = 9.40 s</div>
</div><!-- fragment --><p>See the <a class="el" href="tutorials.html">detailed tutorials</a> for more. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="getting_started.html">Getting started</a></li>
    <li class="footer">Generated on Mon Mar 2 2026 04:48:12 for ampsci by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
